jQuery.fn.insertAtCaret = function(textFeildValue){ 			var textObj = $(this).get(0); 			if(document.all && textObj.createTextRange && textObj.caretPos){ 				var caretPos=textObj.caretPos; 				caretPos.text = caretPos.text.charAt(caretPos.text.length-1) == '' ? 					textFeildValue+'' : textFeildValue; 			} 			else if(textObj.setSelectionRange){ 				var rangeStart=textObj.selectionStart; 				var rangeEnd=textObj.selectionEnd; 				var tempStr1=textObj.value.substring(0,rangeStart); 				var tempStr2=textObj.value.substring(rangeEnd); 				textObj.value=tempStr1+textFeildValue+tempStr2; 				textObj.focus(); 				var len=textFeildValue.length; 				textObj.setSelectionRange(rangeStart+len,rangeStart+len); 				textObj.blur(); 			} 			else { 				textObj.value+=textFeildValue; 			} 	} jQuery.fn.extend({	highText : function (searchWords, htmlTag, tagClass) {		return this.each(function() {			$(this).html(function high(replaced, search, htmlTag, tagClass) {				var pattarn = search.replace(/\b(\w+)\b/g, "($1)").replace(/\s+/g, "|");								return replaced.replace(new RegExp(pattarn, "ig"), function(keyword) {					return $("<" + htmlTag + " class=" + tagClass + ">" + keyword + "</" + htmlTag + ">").outerHTML();				});			}($(this).text(), searchWords, htmlTag, tagClass));		});	},	outerHTML : function(s) {		return (s) ? this.before(s).remove() : jQuery("<p>").append(this.eq(0).clone()).html();	},		//图片插入操作		addTextpicTure:function(){			var textFeildValue = '\n!['+($('#addTxtForms :input[name="imgsAlt"]').val())+']('+$('#addTxtForms :input[name="imgsUrl"]').val()+')';			$('#advanced_editor') == null ? '' :			$('#advanced_editor').insertAtCaret(textFeildValue);			}, 		//插入视频操作		addVideo:function(){			if ($('#addTxtForms :input[name="videoUrl"]').val().indexOf('.swf') != -1)			{				alert(_t('请输入视频网站页面地址, 不是播放器地址'));								return false;			}			var textFeildValue = '\n!!['+($('#addTxtForms :input[name="videoTitle"]').val())+']('+$('#addTxtForms :input[name="videoUrl"]').val()+')';			$('#advanced_editor') == null ? '' :			$('#advanced_editor').insertAtCaret(textFeildValue), $('#closeDefault').click();		}, 		// 设置编辑器预览状态		setEditorPreview:function(){			if ($.cookie('data_editor_preview') != 'false')			{    			$('.markItUpButton11 a').addClass('cur');			}			else			{            	$('#markItUpPreviewFrame').toggle();			}		},		// 向编辑器中插入文本		insertIntoCodemirror : function(fn){			var flag = false;            var pos = {};            var cursor = 0;            var textarea = document.getElementById('advanced_editor');            if (advanced_editor != null) {                            pos = advanced_editor.getCursor('start');                                advanced_editor.toTextArea();                                for(var i = 0, iLen = pos.line; i < iLen; i++){                    cursor += advanced_editor.lineInfo(i).text.length + 1;                }                                cursor += pos.ch;				if (textarea.createTextRange){					// quick fix to make it work on Opera 9.5					if ($.browser.opera && $.browser.version >= 9.5 && advanced_editor.getSelection().length == 0) {						return false;					}					range = textarea.createTextRange();					range.collapse(true);					range.moveStart('character', cursor); 					range.moveEnd('character', advanced_editor.getSelection().length); 					range.select();				} else if (textarea.setSelectionRange ){					textarea.setSelectionRange(cursor, cursor + advanced_editor.getSelection().length);				}				textarea.focus();                advanced_editor = null;                flag = true;            }                    fn(arguments[1]);            if(flag){                                               advanced_editor = CodeMirror.fromTextArea(textarea, {                    mode: 'markdown',                    lineNumbers: true,                    theme: "default",                    extraKeys: {"Enter": "newlineAndIndentContinueMarkdownList"}                });                if(typeof arguments[1] != 'undefined' && (arguments[1].offset || arguments[1].addline)){                	pos.line += (arguments[1].addline ? arguments[1].addline : 0);                	pos.ch += (arguments[1].offset ? arguments[1].offset : 0);                }                advanced_editor.setCursor(pos);            }		}});// Test:/*$(document).ready(function () {	$('.footer a').highText('关于', 'span', 't');});*/$.alert = function( text ) {	if ($('.alert-box').length)	{		$('.alert-box').remove();	}		$('#aw-ajax-box').append(Hogan.compile(AW_TEMPLATE.alertBox).render({ message : text }));		$(".alert-box").modal('show').css({		left : $(window).width() / 2 - $(".alert-box").width() / 2	});};function _t(string, replace){		if (typeof(aws_lang) != 'undefined')	{		if (typeof(aws_lang[string]) != 'undefined')		{			string = aws_lang[string];		}	}		if (replace)	{		string = string.replace('%s', replace);	}			return string;}function ajax_request(url, params){		if (params)	{		$.post(url, params, function (result) {			if (result.err)			{				$.alert(result.err);			}			else if (result.rsm && result.rsm.url)			{				window.location = decodeURIComponent(result.rsm.url);			}			else			{				window.location.reload();			}		}, 'json').error(function (error) { if ($.trim(error.responseText) != '') { alert(_t('发生错误, 返回的信息:') + ' ' + error.responseText); } });	}	else	{		$.get(url, function (result) {			if (result.err)			{				$.alert(result.err);			}			else if (result.rsm && result.rsm.url)			{				window.location = decodeURIComponent(result.rsm.url);			}			else			{				window.location.reload();			}		}, 'json').error(function (error) { if ($.trim(error.responseText) != '') { alert(_t('发生错误, 返回的信息:') + ' ' + error.responseText); } });	}		return false;}function ajax_post(formEl, processer)	// 表单对象，用 jQuery 获取，回调函数名{		if (typeof(processer) != 'function')	{		processer = _ajax_post_processer;	}	else	{		if (document.getElementById('tip_error_message'))		{			$('#tip_error_message').hide();		}				$('span.err').hide();	}		var custom_data = {_post_type:'ajax'};		formEl.ajaxSubmit({		dataType: 'json',		data: custom_data,		success: processer,		error:	function (error) { if ($.trim(error.responseText) != '') { alert(_t('发生错误, 返回的信息:') + ' ' + error.responseText); } }	});}function _ajax_post_processer(result){		if (typeof(result.errno) == 'undefined')	{		$.alert(result);	}	else if (result.errno != 1)	{		$.alert(result.err);	}	else	{				if (result.rsm && result.rsm.url)		{			window.location = decodeURIComponent(result.rsm.url);		}		else		{			window.location.reload();		}	}}function _ajax_post_modal_processer(result){	if (typeof(result.errno) == 'undefined')	{		alert(result);	}	else if (result.errno != 1)	{		alert(result.err);	}	else	{		if (result.rsm && result.rsm.url)		{			window.location = decodeURIComponent(result.rsm.url);		}		else		{			$('#aw-ajax-box div.modal').modal('hide');		}	}}function _ajax_post_alert_processer(result){	if (typeof(result.errno) == 'undefined')	{		alert(result);	}	else if (result.errno != 1)	{		alert(result.err);	}	else	{		if (result.rsm && result.rsm.url)		{			window.location = decodeURIComponent(result.rsm.url);		}		else		{			window.location.reload();		}	}}function _ajax_post_confirm_processer(result){	if (typeof(result.errno) == 'undefined')	{		alert(result);	}	else if (result.errno != 1)	{		if (!confirm(result.err))		{			return false;			}	}		if (result.errno == 1 && result.err)	{		alert(result.err);	}		if (result.rsm && result.rsm.url)	{		window.location = decodeURIComponent(result.rsm.url);	}	else	{		window.location.reload();	}}function focus_question(el, question_id){	if (el.html())	{		if (!el.hasClass('aw-active'))		{			el.html(_t('关注'));		}		else		{			el.html(_t('取消关注'));		}	}	else	{		if (!el.hasClass('aw-active'))		{			el.attr('data-original-title', _t('关注'));		}		else		{			el.attr('data-original-title', _t('取消关注'));		}	}		el.addClass('loading').addClass('disabled');		$.get(G_BASE_URL + '/question/ajax/focus/question_id-' + question_id, function (data)	{		if (data.errno == 1)		{			if (data.rsm.type == 'add')			{				el.removeClass('aw-active');			}			else			{				el.addClass('aw-active');			}		}		else		{			if (data.err)			{				$.alert(data.err);			}						if (data.rsm.url)			{				window.location = decodeURIComponent(data.rsm.url);			}		}				el.removeClass('loading').removeClass('disabled');	}, 'json');}function focus_topic(el, topic_id){	if (el.html())	{		if (!el.hasClass('aw-active'))		{			el.html(_t('关注'));		}		else		{			el.html(_t('取消关注'));		}	}	else	{		if (!el.hasClass('aw-active'))		{			el.attr('data-original-title', _t('关注'));		}		else		{			el.attr('data-original-title', _t('取消关注'));		}	}		el.addClass('loading').addClass('disabled');		$.get(G_BASE_URL + '/topic/ajax/focus_topic/topic_id-' + topic_id, function (data)	{		if (data.errno == 1)		{			if (data.rsm.type == 'add')			{				el.removeClass('aw-active');			}			else			{				el.addClass('aw-active');			}		}		else		{			if (data.err)			{				$.alert(data.err);			}						if (data.rsm.url)			{				window.location = decodeURIComponent(data.rsm.url);			}		}				el.removeClass('loading').removeClass('disabled');	}, 'json');}function follow_people(el, uid){	if (el.html())	{		if (!el.hasClass('aw-active'))		{			el.html(_t('关注'));		}		else		{			el.html(_t('取消关注'));		}	}	else	{		if (!el.hasClass('aw-active'))		{			el.attr('data-original-title', _t('关注'));		}		else		{			el.attr('data-original-title', _t('取消关注'));		}	}		el.addClass('loading').addClass('disabled');		$.get(G_BASE_URL + '/follow/ajax/follow_people/uid-' + uid, function (data)	{		if (data.errno == 1)		{			if (data.rsm.type == 'add')			{				el.removeClass('aw-active');			}			else			{				el.addClass('aw-active');			}		}		else		{			if (data.err)			{				$.alert(data.err);			}						if (data.rsm.url)			{				window.location = decodeURIComponent(data.rsm.url);			}		}				el.removeClass('loading').removeClass('disabled');	}, 'json');}function check_notifications(){	if (G_USER_ID == 0)	{		return false;	}		$.get(G_BASE_URL + '/home/ajax/notifications/', function (result) {				$('.inbox_num').html(Number(result.rsm.inbox_num));				last_unread_notification = G_UNREAD_NOTIFICATION;				G_UNREAD_NOTIFICATION = Number(result.rsm.notifications_num);		if (G_UNREAD_NOTIFICATION > 0)		{			if (G_UNREAD_NOTIFICATION != last_unread_notification)			{				reload_notification_list();								$('#notifications_num').html(G_UNREAD_NOTIFICATION);			}		}		else		{			if ($('#header_notification_list').length > 0)			{				$("#header_notification_list").html('<p style="padding: 0" align="center">' + _t('没有未读通知') + '</p>').next('[name=operater]').hide();			}			if ($("#index_notification").length > 0)			{				$("#index_notification").fadeOut().find('[name=notification_unread_num]').html(0).parent().next('ul#notification_list').html('');			}			if (('#tab_all_notifications').length > 0)			{				$('#tab_all_notifications').click();			}		}				if (Number(result.rsm.notifications_num) > 0)		{			document.title = '(' + (Number(result.rsm.notifications_num) + Number(result.rsm.inbox_num)) + ') ' + document_title;						$('#notifications_num').show();		}		else		{			document.title = document_title;						$('#notifications_num').hide();		}				if (Number(result.rsm.inbox_num) > 0)		{			$('.inbox_num').show();		}		else		{			$('.inbox_num').hide();		}				if (((Number(result.rsm.notifications_num) + Number(result.rsm.inbox_num))) > 0)		{			document.title = '(' + (Number(result.rsm.notifications_num) + Number(result.rsm.inbox_num)) + ') ' + document_title;		}		else		{			document.title = document_title;		}	}, 'json');}function reload_notification_list(){	if ($("#index_notification").length > 0)	{		$("#index_notification").fadeIn().find('[name=notification_unread_num]').html(G_UNREAD_NOTIFICATION).parent().next('ul#notification_list').html('<p align="center" style="padding: 15px 0"><img src="' + G_STATIC_URL + '/common/loading_b.gif"/></p>');		$.get(G_BASE_URL + '/notifications/ajax/list/flag-0__page-0', function (index_response)		{			if (index_response.length)			{				$("#index_notification").find('ul#notification_list').html(index_response);								notification_show(5);			}		});	}	if ($("#header_notification_list").length > 0)	{		$("#header_notification_list").html('<p align="center"><img src="' + G_STATIC_URL + '/common/loading_b.gif"/></p>');		$.get(G_BASE_URL + '/notifications/ajax/list/flag-0__limit-5__template-header_list', function (response)		{			if (response.length)			{				$("#header_notification_list").html(response).next('[name=operater]').show();							}			else			{				$("#header_notification_list").html('<p style="padding: 0" align="center">' + _t('没有未读通知') + '</p>').next('[name=operater]').hide();			}		});	}}function read_notification(notification_id, el, reload){	if (notification_id)	{		el.remove();		notification_show(5);				if ($("#announce_num").length > 0)		{			$("#announce_num").html(String(G_UNREAD_NOTIFICATION-1));		}				if ($("#notifications_num").length > 0)		{			$("#notifications_num").html(String(G_UNREAD_NOTIFICATION-1));		}				var url = G_BASE_URL + '/notifications/ajax/read_notification/notification_id-' + notification_id + '__read_type-1';	}	else	{		if ($("#index_notification").length > 0)		{			$("#index_notification").fadeOut();		}				var url = G_BASE_URL + '/notifications/ajax/read_notification/read_type-0';	}		$.get(url, function (respose)	{		check_notifications();		if (reload)		{			window.location.reload();		}	});}function notification_show(max){	if ($('#index_notification').length > 0)	{		var n_count = 0;				$('#index_notification').find('ul#notification_list').find("li").each(function()		{			if (n_count < 5)			{				$(this).show();			}			else			{				$(this).hide();			}						n_count++;		});				if ($('#index_notification').find('ul#notification_list').find("li").size() == 0)		{			$('#index_notification').fadeOut();		}	}}function ajax_load(url, target){	$(target).html('<p style="padding: 15px 0" align="center"><img src="' + G_STATIC_URL + '/common/loading_b.gif" alt="" /></p>');		$.get(url, function (response)		{			if (response.length)			{				$(target).html(response);			}			else			{				$(target).html('<p style="padding: 15px 0" align="center">' + _t('没有内容') + '</p>');			}	});}var _bp_more_o_inners = new Array();var _bp_more_pages = new Array();function bp_more_load(url, bp_more_o_inner, target_el, start_page, callback_func){	if (!bp_more_o_inner.attr('id'))	{		return false;	}		if (!start_page)	{		start_page = 0	}		_bp_more_pages[bp_more_o_inner.attr('id')] = start_page;		_bp_more_o_inners[bp_more_o_inner.attr('id')] = bp_more_o_inner.html();		bp_more_o_inner.unbind('click');		bp_more_o_inner.bind('click', function () {		var _this = this;					$(this).addClass('loading');				$(this).find('a').html(_t('正在载入') + '...');					$.get(url + '__page-' + _bp_more_pages[bp_more_o_inner.attr('id')], function (response)		{			if ($.trim(response) != '')			{				if (_bp_more_pages[bp_more_o_inner.attr('id')] == start_page && $(_this).attr('auto-load') != 'false')				{					target_el.html(response);				}				else				{					target_el.append(response);				}											_bp_more_pages[bp_more_o_inner.attr('id')]++; 								$(_this).html(_bp_more_o_inners[bp_more_o_inner.attr('id')]);			}			else			{				if (_bp_more_pages[bp_more_o_inner.attr('id')] == start_page && $(_this).attr('auto-load') != 'false')				{					target_el.html('<p style="padding: 15px 0" align="center">' + _t('没有内容') + '</p>');				}											$(_this).addClass('disabled').unbind('click').bind('click', function () { return false; });										$(_this).find('a').html(_t('没有更多了'));			}							$(_this).removeClass('loading');						if (callback_func != null)			{				callback_func();			}		});					return false;	});		if (bp_more_o_inner.attr('auto-load') != 'false')	{		bp_more_o_inner.click();	}}function content_switcher(hide_el, show_el){	hide_el.hide();	show_el.fadeIn();}function _tips_form_processer(result){	if (typeof(result.errno) == 'undefined')	{		alert(result);	}	else if (result.errno != 1)	{				if (typeof(result.rsm) == 'undefined')		{			if (document.getElementById('tip_error_message'))			{				$('#tip_error_message').html(result.err).show();			}				else			{				$.alert(result.err);			}		}		else if (result.rsm)		{				var selecter = 'input[name=' + result.rsm.input + '], select[name=' + result.rsm.input + ']';						if (document.getElementById('tip_' + result.rsm.tips_id))			{				$('#tip_' + result.rsm.tips_id).html(result.err).show();			}			else if (document.getElementById(result.rsm.tips_id))			{				$('#' + result.rsm.tips_id).html(result.err).show();			}			else if ($('#tip_' + $(selecter).attr('id')).attr('id'))			{				if (!$('#tip_' + $(selecter).attr('id')).hasClass('default_err') && !$('#tip_' + $(selecter).attr('id')).hasClass('all_err_tips'))				{					$('#tip_' + $(selecter).attr('id')).removeClass().addClass('err').html(result.err).show();				}				else				{					$('#tip_' + $(selecter).attr('id')).html(result.err).show();				}			}			else if (document.getElementById('tip_error_message'))			{				$('#tip_error_message').html(result.err).show();			}					else			{				$.alert(result.err);			}		}		else		{			if (document.getElementById('tip_error_message'))			{				$('#tip_error_message').html(result.err).show();			}				else			{				$.alert(result.err);			}		}	}	else	{		if (result.rsm && result.rsm.url)		{			window.location = decodeURIComponent(result.rsm.url);		}		else if (result.err && document.getElementById('tip_success_message'))		{			$.scrollTo(0, 800, {queue:true});						$('#tip_success_message').html(result.err).fadeIn();						setTimeout(function () {				$('#tip_success_message').fadeOut();			}, 3000);		}		else		{			window.location.reload();		}	}}function hightlight(el, class_name){	if (el.hasClass(class_name))	{		return true;	}		//window.scrollTo(0, (el.position()['top'] - 5));		var hightlight_timer_front = setInterval(function () {		el.addClass(class_name);	}, 500);		var hightlight_timer_background = setInterval(function () {		el.removeClass(class_name);	}, 600);		setTimeout(function () {		clearInterval(hightlight_timer_front);		clearInterval(hightlight_timer_background);				el.addClass(class_name);	}, 1200);		setTimeout(function () {		el.removeClass(class_name);	}, 6000);}function nl2br(str){	return str.replace(new RegExp("\r\n|\n\r|\r|\n", "g"), "<br />");}function init_img_uploader(upload_url, upload_name, upload_element, upload_status_elememt, perview_element){    return new AjaxUpload(upload_element, {        action: upload_url,        name: upload_name,        responseType: 'json',                onSubmit: function (file, ext) {            if (!new RegExp('(png|jpe|jpg|jpeg|gif)$', 'i').test(ext))            {                alert('上传失败: 只支持 jpg、gif、png 格式的图片文件');                                return false;            }			            this.disable();                        if (upload_status_elememt)            {            	upload_status_elememt.show();            }        },                onComplete: function (file, response) {            this.enable();            			if (upload_status_elememt)            {            	upload_status_elememt.hide();            }                        if (response.errno == -1)			{            	alert(response.err);        	}        	else        	{        		if (typeof(perview_element.attr('src')) != 'undefined')        		{	        		perview_element.attr('src', response.rsm.preview + '?' + Math.floor(Math.random() * 10000));        		}        		else        		{	        		perview_element.css('background-image', 'url(' + response.rsm.preview + '?' + Math.floor(Math.random() * 10000) + ')');        		}            }		        }    });}function init_avatar_uploader(upload_element, upload_status_elememt, avatar_element){	return init_img_uploader(G_BASE_URL + '/account/ajax/avatar_upload/', 'user_avatar', upload_element, upload_status_elememt, avatar_element);}function init_fileuploader(element_id, action_url){	if (!document.getElementById(element_id))	{		return false;	}		return new _ajax_uploader.FileUploader({		element: document.getElementById(element_id),		action: action_url,		debug: false	});}function htmlspecialchars(text)  {      return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;');}function delete_draft(item_id, type){	$.post(G_BASE_URL + '/account/ajax/delete_draft/', 'item_id=' + item_id + '&type=' + type, function (result) {		if (result.errno != 1)		{			$.alert(result.err);		}	}, 'json');}function agree_vote(answer_id, value){	$.post(G_BASE_URL + '/question/ajax/answer_vote/', "answer_id=" + answer_id + "&value=" + value, function (result) {		if (result.errno == -1)		{			$.alert(result.err);		}	}, 'json');}//问题-不感兴趣function question_uninterested(el, question_id){	el.fadeOut();		$.post(G_BASE_URL + '/question/ajax/uninterested/', 'question_id=' + question_id, function (result) {		if (result.errno != '1')		{			alert(result.err);		}	}, 'json');}function question_invite_delete(el, question_invite_id){	$.post(G_BASE_URL + '/question/ajax/question_invite_delete/', 'question_invite_id=' + question_invite_id, function (result) {		if (result.errno == '1')		{			el.parent().parent().remove();		}		else		{			alert(result.rsm.err);		}	}, 'json');}function toggle_comments(item_id, type_name,e,callback){		if ($('#' + type_name + '_comments_' + item_id).css('display') == 'none')	{		if ($('#' + type_name + '_comments_' + item_id + ' div[name=comments_list]').html() == '')		{			reload_comments_list(item_id, item_id, type_name);		}				$('#' + type_name + '_comments_' + item_id).fadeIn('normal'); 			}	else	{		$('#' + type_name + '_comments_' + item_id).hide();	}	callback != null ? callback.call(this,item_id,type_name,e) :''}function reload_comments_list(item_id, element_id, type_name){	$('#aw-comment-box-' + type_name + '-' + element_id + ' .aw-comment-list').html('<p align="center" class="aw-padding10"><i class="aw-loading"></i></p>');		$.get(G_BASE_URL + '/question/ajax/get_' + type_name + '_comments/' + type_name + '_id-' + item_id, function (data) {		$('#aw-comment-box-' + type_name + '-' + element_id + ' .aw-comment-list').html(data);	});}function header_message(message){	$('<div/>').addClass('reply_div').html('<p><!--<span class="s"></span>-->' + message + '</p>').insertBefore($('#default_msg').find('p.transparent'));}function save_comment(save_button_el){	$(save_button_el).attr('_onclick', $(save_button_el).attr('onclick')).addClass('disabled').removeAttr('onclick').addClass('_save_comment');		ajax_post($(save_button_el).parents('form'), _comments_form_processer);}function _comments_form_processer(result){	$.each($('a._save_comment.disabled'), function (i, e) {		$(e).attr('onclick', $(this).attr('_onclick')).removeAttr('_onclick').removeClass('disabled').removeClass('_save_comment');	});		if (result.errno != 1)	{		$.alert(result.err);	}	else	{		reload_comments_list(result.rsm.item_id, result.rsm.item_id, result.rsm.type_name);				$('#aw-comment-box-' + result.rsm.type_name + '-' + result.rsm.item_id + ' form input').val('');		$('#aw-comment-box-' + result.rsm.type_name + '-' + result.rsm.item_id + ' form').fadeOut();	}}function remove_comment(el, type, comment_id){	$(el).parents('li').fadeOut('slow',function(){		$(this).remove();				$.get(G_BASE_URL + '/question/ajax/remove_comment/type-' + type + '__comment_id-' + comment_id);	});}function insert_attach(el, attach_id, attach_tag){	$(el).parents('form').find('textarea').val($(el).parents('form').find('textarea').val() + "\n[" + attach_tag + "]" + attach_id + "[/" + attach_tag + "]\n");}function question_thanks(question_id, element){	$.post(G_BASE_URL + '/question/ajax/question_thanks/', 'question_id=' + question_id, function (result) {		if (result.errno != 1)		{			$.alert(result.err);		}		else if (result.rsm.action == 'add')		{			$(element).html($(element).html().replace(_t('感谢'), _t('已感谢')));			$(element).removeAttr('onclick');		}		else		{			$(element).html($(element).html().replace(_t('已感谢'), _t('感谢')));		}	}, 'json');}function answer_user_rate(answer_id, type, element){	$.post(G_BASE_URL + '/question/ajax/question_answer_rate/', 'type=' + type + '&answer_id=' + answer_id, function (result) {		if (result.errno != 1)		{			$.alert(result.err);		}		else if (result.errno == 1)		{			switch (type)			{				case 'thanks':					if (result.rsm.action == 'add')					{						$(element).html(_t('已感谢'));						$(element).removeAttr('onclick');					}					else					{						$(element).html(_t('感谢'));					}				break;								case 'uninterested':					if (result.rsm.action == 'add')					{						$(element).html(_t('撤消没有帮助'));					}					else					{						$(element).html(_t('没有帮助'));					}				break;			}		}	}, 'json');}function init_comment_box(selecter){	$(document).on('click', selecter, function()	{			if (!$(this).attr('aw-comment-data-type') || !$(this).attr('aw-comment-data-id'))		{			return true;		}				var comment_box_id = '#aw-comment-box-' + $(this).attr('aw-comment-data-type') + '-' +　$(this).attr('aw-comment-data-id');				if ($(comment_box_id).length > 0)		{			if ($(comment_box_id).css('display') == 'none')			{				$(comment_box_id).fadeIn();			}			else			{				$(comment_box_id).fadeOut();			}		}		else		{			// 动态插入commentBox			switch ($(this).attr('aw-comment-data-type'))			{				case 'question':					var comment_form_action = G_BASE_URL + '/question/ajax/save_question_comment/question_id-' + $(this).attr('aw-comment-data-id');					var comment_data_url = G_BASE_URL + '/question/ajax/get_question_comments/question_id-' + $(this).attr('aw-comment-data-id');				break;								case 'answer':					var comment_form_action = G_BASE_URL + '/question/ajax/save_answer_comment/answer_id-' + $(this).attr('aw-comment-data-id');					var comment_data_url = G_BASE_URL + '/question/ajax/get_answer_comments/answer_id-' + $(this).attr('aw-comment-data-id');				break;			}						$(this).parent().parent().append(Hogan.compile(AW_TEMPLATE.commentBox).render({				'comment_form_id' : comment_box_id.replace('#', ''),				'comment_form_action' : comment_form_action			}));			//判断是否有评论数据			$.get(comment_data_url, function (result) {				$(comment_box_id).find('.aw-comment-list').html(result);			});						/*评论操作box内textarea点击效果*/			$(comment_box_id).find('.aw-comment-txt').bind({				focus : function()				{					$(this).css('height',parseInt($(this).css('line-height')) * 5);										$(comment_box_id).find('.aw-comment-box-btn').show();				},								blur : function()				{					if ($(this).val() == '')					{						$(this).css('height',parseInt($(this).css('line-height')));												$(comment_box_id).find('.aw-comment-box-btn').hide();					}				}			});						$(comment_box_id).find('.close-comment-box').click(function()			{				$(comment_box_id).fadeOut();				$(comment_box_id).find('.aw-comment-txt').css('height', $(this).css('line-height'));			});						/*给三角形定位*/			$(comment_box_id).find('.i-comment-triangle').css('left', ($(this).width()) / 2 + $(this).prev().width() + 15);		}	});	//http://wenda.wecenter.com/anwsion1__limit-10	}//话题编辑下拉菜单function get_topic_list_data(){	if ($('#aw_edit_topic_title').val().length > 2)	{		$('.aw-edit-topic-box .aw-topic-dropdown-list').html('');		$.get(G_BASE_URL + '/search/ajax/search/?type-topic__q-' + $('#aw_edit_topic_title').val() + '__limit-10', function (result) {			if (result.length != 0)			{				$.each(result,function(i, a)				{					$('.aw-edit-topic-box .aw-topic-dropdown .aw-topic-dropdown-list').append(Hogan.compile(AW_TEMPLATE.editTopicDorpdownList).render({						'name': a['name']					}));				});				$('.aw-edit-topic-box .aw-topic-dropdown').css('width',$('.aw-edit-topic-box #aw_edit_topic_title').width()+12).show();			}else			{				$('.aw-edit-topic-box .aw-topic-dropdown').hide();			}		},'json');	}else	{		$('.aw-edit-topic-box .aw-topic-dropdown').hide();	}}$(document).on('mouseover','.aw-topic-dropdown-list li',function(){	$('.aw-edit-topic-box #aw_edit_topic_title').val($(this).text());});$(document).on('click','.aw-topic-dropdown-list li',function(){	$('.aw-edit-topic-box #aw_edit_topic_title').val($(this).text());	$('.aw-edit-topic-box .submit-edit').click();	$('.aw-edit-topic-box .aw-topic-dropdown').hide();});//话题编辑下拉菜单失去焦点function hide_topic_list(){	$('.aw-edit-topic-box .aw-topic-dropdown').hide();}//问题重定向下拉function get_question_list_data(){	if ($('.aw-question-redirect-box #question-input').val().length > 2)	{		$('.aw-question-redirect-box .aw-question-dropdown-list').html('');		$.get(G_BASE_URL + '/search/ajax/search/?q=' + $('.aw-question-redirect-box #question-input').val() + '&type=question&limit-30', function (result) {			if (result.length != 0)			{				$.each(result,function(i, a){					$('.aw-question-redirect-box .aw-question-dropdown-list').append(Hogan.compile(AW_TEMPLATE.questionRedirectList).render({						'url' : "'"+G_BASE_URL+"/question/ajax/redirect/', 'item_id=" + $('.aw-question-redirect-box #question-input').attr('data-id') + "&target_id="+a['sno']+"'",						'name' : a['name']					}));				});				$('.aw-question-redirect-box .aw-topic-dropdown').show();			}else			{				$('.aw-question-redirect-box .aw-topic-dropdown').hide();			}		},'json');	}else{		$('.aw-question-redirect-box .aw-topic-dropdown').hide();	}}function insertVoteBar(data){	// {element:this,agree_count:20,flag:0,user_name:G_USER_NAME,answer_id:1230};	switch (data.flag)	{		case 1:			up_class = 'active';			down_class = '';		break;				case -1:			up_class = '';			down_class = 'active';		break;				case 0:			up_class = '';			down_class = '';		break;	}		$(data.element).parent().prepend(Hogan.compile(AW_TEMPLATE.voteBar).render({		'agree_count' : data.agree_count,		'up_class' : up_class,		'down_class' : down_class,		'user_name' : data.user_name,		'answer_id' : data.answer_id	}));		$(data.element).detach();}function agreeVote(element, user_name, answer_id){	//判断是否投票过	if ($(element).parents('.aw-item').find('.aw-agree-by').text().match(user_name))	{		$.post(G_BASE_URL + '/question/ajax/answer_vote/', 'answer_id=' + answer_id + '&value=-1', function (result) {});				$.each($(element).parents('.aw-item').find('.aw-user-name'), function (i, e) {			if ($(e).html() == user_name)			{				if ($(e).prev())				{					$(e).prev().remove();				}				else				{					$(e).next().remove();				}								$(e).remove();			}		});			$(element).removeClass('active');				if ($(element).parents('.aw-item').find('.aw-agree-by a').length == 0)		{			$(element).parents('.aw-item').find('.aw-agree-by').hide();		}	}	else	{		$.post(G_BASE_URL + '/question/ajax/answer_vote/', 'answer_id=' + answer_id + '&value=1', function (result) {});				//判断是否第一个投票		if ($(element).parents('.aw-item').find('.aw-agree-by .aw-user-name').length == 0)		{			$(element).parents('.aw-item').find('.aw-agree-by').append('<a class="aw-user-name">'+ user_name +'</a>');		}		else		{			//插入动画效果			$(element).parents('.aw-item').find('.aw-agree-by').append('<em>、</em><a class="aw-user-name">'+ user_name +'</a>');		}				$(element).parents('.aw-item').find('.aw-agree-by').show();				$(element).parents('.aw-item').find('a.active').removeClass('active');		$(element).addClass('active');	}}//反对投票function disagreeVote(element, user_name, answer_id){	$.post(G_BASE_URL + '/question/ajax/answer_vote/', 'answer_id=' + answer_id + '&value=-1', function (result) {});		//判断是否投票过	if (!$(element).hasClass('active'))	{		//删除赞同操作		$.each($(element).parents('.aw-item').find('.aw-user-name'), function (i, e) {			if ($(e).html() == user_name)			{				if ($(e).prev())				{					$(e).prev().remove();				}				else				{					$(e).next().remove();				}								$(e).remove();			}		});				$(element).parents('.aw-item').find('a.active').removeClass('active');		$(element).addClass('active');				if ($(element).parents('.aw-item').find('.aw-agree-by a').length == 0)		{			$(element).parents('.aw-item').find('.aw-agree-by').hide();		}	}	else	{		$(element).removeClass('active');	}}function init_topic_edit_box(selecter) //selecter -> .aw-edit-topic{	$(selecter).click(function() {		var _aw_topic_editor_element = $(this).parents('.aw-topic-editor');		var data_id = _aw_topic_editor_element.attr('data-id');		var data_type = _aw_topic_editor_element.attr('data-type');				if (!_aw_topic_editor_element.find('.aw-topic-name').children().hasClass('i-close-hover'))		{			_aw_topic_editor_element.find('.aw-topic-name').children().append('<i class="aw-icon i-close-hover"></i>');						$.each(_aw_topic_editor_element.find('.i-close-hover'), function (i, e) {				$(e).click(function () {										switch (data_type)					{						case 'question':							$.post(G_BASE_URL + '/question/ajax/delete_topic/', 'question_id=' + data_id + '&topic_id=' + $(this).parents('.aw-topic-name').attr('data-id'));						break;												case 'topic':							$.get(G_BASE_URL + '/topic/ajax/remove_related_topic/related_id-' + $(this).parents('.aw-topic-name').attr('data-id') + '__topic_id-' + data_id);						break;												case 'favorite':							$.post(G_BASE_URL + '/favorite/ajax/remove_favorite_tag/', 'answer_id=' + data_id + '&tags=' + $(this).parents('.aw-topic-name').text());						break;					}										$(this).parents('.aw-topic-name').remove();										return false;				});			});		}		else		{			_aw_topic_editor_element.find('.i-close-hover').show();		}		/*判断插入编辑box*/		if (_aw_topic_editor_element.find('.aw-edit-topic-box').length == 0)		{			_aw_topic_editor_element.append(AW_TEMPLATE.editTopicBox);						//给编辑box取消按钮添加事件			_aw_topic_editor_element.find('.close-edit').click(function()			{				_aw_topic_editor_element.find('.aw-edit-topic-box').hide();				_aw_topic_editor_element.find('.i-close-hover').hide();				_aw_topic_editor_element.find('.aw-edit-topic').show();			});						_aw_topic_editor_element.find('.submit-edit').click(function()			{								switch (data_type)				{					case 'question':						$.post(G_BASE_URL + '/question/ajax/save_topic/question_id-' + data_id, 'topic_title=' + _aw_topic_editor_element.find('#aw_edit_topic_title').val(), function (result) {							if (result.errno != 1)							{								$.alert(result.err);																return false;							}														_aw_topic_editor_element.prepend('<a href="' + G_BASE_URL + '/topic/' + result.rsm.topic_id + '" class="aw-topic-name"><span>' + _aw_topic_editor_element.find('#aw_edit_topic_title').val() + '<i class="aw-icon i-close-hover" onclick="$.post(G_BASE_URL + \'/question/ajax/delete_topic/\', \'question_id=' + data_id + '&topic_id=\' + $(this).parents(\'.aw-topic-name\').attr(\'data-id\'));$(this).parents(\'.aw-topic-name\').remove();return false;"></i></span></a>').hide().fadeIn();														_aw_topic_editor_element.find('#aw_edit_topic_title').attr('value', '');						}, 'json');					break;										case 'topic':						$.post(G_BASE_URL + '/topic/ajax/save_related_topic/topic_id-' + data_id, 'topic_title=' + _aw_topic_editor_element.find('#aw_edit_topic_title').val(), function (result) {							if (result.errno != 1)							{								$.alert(result.err);																return false;							}														_aw_topic_editor_element.prepend('<a href="' + G_BASE_URL + '/favorite/tag-' + encodeURIComponent(_aw_topic_editor_element.find('#aw_edit_topic_title').val()) + '" class="aw-topic-name"><span>' + _aw_topic_editor_element.find('#aw_edit_topic_title').val() + '<i class="aw-icon i-close-hover" onclick="$.post(G_BASE_URL + \'/topic/ajax/remove_related_topic/related_id-\' + $(this).parents(\'.aw-topic-name\').text() + \'&topic_id=' + data_id + '\');$(this).parents(\'.aw-topic-name\').remove();return false;"></i></span></a>').hide().fadeIn();														_aw_topic_editor_element.find('#aw_edit_topic_title').attr('value', '');						}, 'json');					break;										case 'favorite':						$.post(G_BASE_URL + '/favorite/ajax/update_favorite_tag/', 'answer_id=' + data_id + '&tags=' + _aw_topic_editor_element.find('#aw_edit_topic_title').val(), function (result) {							if (result.errno != 1)							{								$.alert(result.err);																return false;							}														_aw_topic_editor_element.prepend('<a href="' + G_BASE_URL + '/favorite/tag-' + encodeURIComponent(_aw_topic_editor_element.find('#aw_edit_topic_title').val()) + '" class="aw-topic-name"><span>' + _aw_topic_editor_element.find('#aw_edit_topic_title').val() + '<i class="aw-icon i-close-hover" onclick="$.post(G_BASE_URL + \'/favorite/ajax/remove_favorite_tag/\', \'answer_id=' + data_id + '&topic_id=\' + $(this).parents(\'.aw-topic-name\').text());$(this).parents(\'.aw-topic-name\').remove();return false;"></i></span></a>').hide().fadeIn();														_aw_topic_editor_element.find('#aw_edit_topic_title').attr('value', '');						}, 'json');					break;				}			});		}				$(this).parent().find('.aw-edit-topic-box').fadeIn();				/*隐藏话题编辑按钮*/		$(this).hide();	});}/***	公共弹窗*	alert       : 普通问题提示*	publish     : 发起*	shareOut    : 站外分享*	shareIn     : 站内私信*	redirect    : 问题重定向*	imageBox    : 插入图片*	videoBox    : 插入视频*	commentEdit : 评论编辑*   favorite    : 评论添加收藏*	inbox       : 新私信*/$.dialog = function(type_id, data){	switch (type_id)	{		case 'alert':			var template = Hogan.compile(AW_TEMPLATE.alertBox).render({				'message' : data			});		break;				case 'publish':			var template = Hogan.compile(AW_TEMPLATE.publishBox).render({				'message' : data			});		break;				case 'shareOut':			var template = Hogan.compile(AW_TEMPLATE.shareBoxOutside).render({				'items' : AW_TEMPLATE.shareList,				'textareaContent' : '我看到一个不错的问题, 想和你分享: WeCenter 2.0 正式版发布 http://wenda.wecenter.com/question/8892?fromuid=5167'			});		break;				case 'shareIn':			var template = Hogan.compile(AW_TEMPLATE.shareBoxMessage).render({				'items' : AW_TEMPLATE.shareList,				'textareaContent' : '我看到一个不错的问题, 想和你分享: WeCenter 2.0 正式版发布 http://wenda.wecenter.com/question/8892?fromuid=5167'			});		break;				case 'redirect':			var template = Hogan.compile(AW_TEMPLATE.questionRedirect).render({				'data_id' : data			});		break;				case 'imageBox':			var template = Hogan.compile(AW_TEMPLATE.imagevideoBox).render({				'title' : '插入图片',				'url' : 'imgsUrl',				'tips' : 'imgsAlt',				'add_func' : 'addTextpicTure'			});		break;				case 'videoBox':			var template = Hogan.compile(AW_TEMPLATE.imagevideoBox).render({				'title' : '插入视频',				'url' : 'videoUrl',				'tips' : 'videoTitle',				'add_func' : 'addVideo'			});		break;				case 'commentEdit':			var template = Hogan.compile(AW_TEMPLATE.editCommentBox).render({				'message' : '123'			});		break;				case 'favorite':			var template = Hogan.compile(AW_TEMPLATE.favoriteBox).render({				'answer_id' : data			});		break;				case 'inbox':			var template = AW_TEMPLATE.inbox;		break;	}		if (template)	{		if ($('.alert-box').length)		{			$('.alert-box').remove();		}				$('#aw-ajax-box').html(template);				$(".alert-box").modal('show').css({			left : $(window).width() / 2 - $(".alert-box").width() / 2		});				dragBox('.alert-box .modal-header');				switch (type_id)		{			case 'publish':				$('.aw-publish-box-supplement').click(function()				{					$(this).parents('form').find('.aw-publish-box-supplement-content').toggle();				});				/*动态插入下拉菜单模板*/				add_dropdown_list('.aw-publish-title-dropdown',[					{'name' : 'Anwsion程序'},					{'name' : '建站运营'},					{'name' : '创意与设计'},					{'name' : '问与答'}				]);								$('.aw-publish-box-supplement-content').on({					keydown : function(event)					{ 						if (event.which == 13)						{							switch ($(this).val().split('\n').length)							{								case 4 : $(this).css('height',parseInt($(this).css('height'))+20);										 break;								case 5 : $(this).css('height',parseInt($(this).css('height'))+20);										 break;								case 6 : $(this).css('height',parseInt($(this).css('height'))+20);										 break;								case 7 : $(this).css('height',parseInt($(this).css('height'))+20);										 break;								case 8 : $(this).css('height',parseInt($(this).css('height'))+20);										 break;							}						}					}				});			break;						case 'shareIn':			case 'shareOut':				$('.aw-share-box-tabs a').click(function () {					$(this).addClass('active').siblings().removeClass('active');					$('.aw-share-box-tabs-content .aw-item').eq($(this).index()).show().siblings().hide();				});			break;						case 'favorite':				$.get(G_BASE_URL + '/favorite/ajax/get_favorite_tags/', function (result) {					if (result.length > 0)					{						$('#add_favorite_my_tags').show();					}										$.each(result, function (i, a) {						$('#add_favorite_my_tags').append('<a href="javascript:;" onclick="$(\'#add_favorite_tags\').val($(\'#add_favorite_tags\').val() + \'' + a['title'] + ',\');" class="aw-topic-name"><span>' + a['title'] + '</span></a> ');					});				}, 'json');			break;		}	}}function dragBox(selecter){	$(selecter).on({				mousedown : function(e)				{					var dragX = e.clientX - $(this).offset().left,						dragY = e.clientY - $(this).offset().top,						_this = $(this);					$(document).on({						mousemove : function(e)						{							var left = e.clientX - dragX,								top = e.clientY - dragY - $(window).scrollTop(); 							_this.parent().css({								'left' : left + 'px',								'top'  : top + 'px'							});						},						mouseup : function()						{							$(document).unbind('mousemove');							$(document).unbind('mouseup');						}					});				}			});}/***	功能: 用户头像提示box效果***	nTop    : 焦点到浏览器上边距*	nRight  : 焦点到浏览器右边距*	nBottom : 焦点到浏览器下边距*	left    : 焦点距离文档左偏移量*	top     : 焦点距离文档上偏移量***/var cashUserData = [],cashTopicData = [],cardBoxTimeout;function show_card_box(selecter,type,time,json) //selecter -> .aw-user-name/.aw-topic-name{	if (time){		var time = time;	}else	{		var time = 300;	}	$(document).on('mouseover',selecter,function(){		clearTimeout(cardBoxTimeout);		var _this = $(this),		nTop = _this.offset().top - $(window).scrollTop(),		nRight = $(window).width() - _this.offset().left,		nBottom = $(window).height() - _this.height() - nTop;		card_box_show = setTimeout(function(){			//用户头像box			if (type == 'user')			{				//判断用户id是否存在				if (_this.attr('data-id'))				{					//检查是否有缓存					if (cashUserData.length == 0)					{						//发送请求						_getdata('user','/people/ajax/user_info/uid-');					}else{						var flag = 0;						//遍历缓存中是否含有此id的数据						_checkcash('user');						if (flag == 0)						{							_getdata('user','/people/ajax/user_info/uid-');						}					}				}			}			//话题box			if (type == 'topic')			{				//存在topicid				if (_this.attr('data-id'))				{					//检查是否有缓存					if (cashTopicData.length == 0)					{						_getdata('topic','/topic/ajax/topic_info/topic_id-');					}else					{						var flag = 0;						//遍历缓存中是否含有此id的数据						_checkcash('topic');						if (flag == 0)						{							_getdata('topic','/topic/ajax/topic_info/topic_id-');						}					}				}			}						//通用获取数据			function _getdata(type,url)			{				if (type == 'user')				{					$.ajax({						type : 'GET',						url : G_BASE_URL + url + _this.attr('data-id'),						dataType : 'json',						success : function(result){							var focus = result.focus,focusTxt;							if (focus == 1)							{								focus = '';								focusTxt = '取消关注';							}else							{								focus = 'aw-active';								focusTxt = '关注';							}							//动态插入盒子							$('#aw-ajax-box').html(Hogan.compile(AW_TEMPLATE.userCard).render({								'uid': result.uid,								'img' : result.avatar_file,								'username' : result.user_name,								'weiwang' : result.reputation,								'zantong' : result.agree_count,								'title' : result.signature,								'focus' : focus,								'focusTxt' : focusTxt							}));							_init();							//缓存							cashUserData.push($('#aw-ajax-box').html());							console.log(cashUserData[0]);						}					});				}				if (type == 'topic')				{					$.ajax({						type : 'GET',						url : G_BASE_URL + url + _this.attr('data-id'),						dataType : 'json',						success : function(result){							var focus = result.focus,focusTxt;							if (focus == 1)							{								focus = '';								focusTxt = '取消关注';							}else							{								focus = 'aw-active';								focusTxt = '关注';							}							//动态插入盒子							$('#aw-ajax-box').html(Hogan.compile(AW_TEMPLATE.topicCard).render({								'topicid' : result.topic_id,								'img' : result.topic_pic,								'topicName' : result.topic_title,								'topicTitle' : result.topic_description,								'questionNum' : result.discuss_count,								'followNum' : result.focus_count,								'focus' : focus,								'focusTxt' : focusTxt							}));							_init();							//缓存							cashTopicData.push($('#aw-ajax-box').html());						}					});				}			}			//检测缓存			function _checkcash(type)			{				if (type == 'user')				{					for (var i=0; i<cashUserData.length; i++)					{						//有缓存						if (cashUserData[i].match('cashid="'+_this.attr('data-id')+'"'))						{							$('#aw-ajax-box').html(cashUserData[i]);							$('#aw-card-tips').removeAttr('style');							_init();							flag = 1;						}					}				}				if (type == 'topic')				{					for (var i=0; i<cashTopicData.length; i++)					{						//有缓存						if (cashTopicData[i].match('cashid="'+_this.attr('data-id')+'"'))						{							$('#aw-ajax-box').html(cashUserData[i]);							_init();							flag = 1;						}					}				}			}			//card-box初始化			function _init(){				//正常情况下box显示状态				$('#aw-card-tips').css({					left : _this.offset().left,					top  : _this.offset().top + _this.height() + 2				}).fadeIn();					//非正常状态下判断				if ($('#aw-card-tips').height()+32 > nBottom) //判断下边距不足的情况				{					if ($('#aw-card-tips').width()+32 > nRight) //下边距右边距同时不足的情况					{						$('#aw-card-tips').css({							left : _this.offset().left - $('#aw-card-tips').width()+32,							top  : _this.offset().top - ($('#aw-card-tips').height()+32) - _this.height()/3						}).fadeIn();					}else					{						$('#aw-card-tips').css({							left : _this.offset().left,							top  : _this.offset().top - ($('#aw-card-tips').height()+32) - _this.height()/3						}).fadeIn();					}				}				if ($('#aw-card-tips').width()+32 > nRight) //判断右边距不足的情况				{					if ($('#aw-card-tips').height()+32 > nBottom) //右边距下边距同时不足的情况					{						$('#aw-card-tips').css({							left : _this.offset().left - $('#aw-card-tips').width()+32,							top  : _this.offset().top - ($('#aw-card-tips').height()+32) - _this.height()/3						}).fadeIn();					}else					{						$('#aw-card-tips').css({							left : _this.offset().left - $('#aw-card-tips').width()+32,							top  : _this.offset().top + _this.height() + 3						}).fadeIn();					}				}			}		},time);	});	$(document).on('mouseout',selecter,function(){		clearTimeout(card_box_show);		cardBoxTimeout = setTimeout(function()		{			$('#aw-card-tips').fadeOut();		},600);	});}//提示卡片内关注更新缓存$(document).on('click','.aw-card-tips-user .focus',function(){	var uid = $(this).parents('.aw-card-tips').find('.name').attr('cashid');	for (var i=0; i<cashUserData.length; i++)	{		//存在缓存		if (cashUserData[i].match('cashid="'+uid+'"'))		{			if (cashUserData.length == 1)			{				cashUserData = [];			}else			{				cashUserData = cashUserData.splice(0,i).concat(cashUserData.splice(i,cashUserData.length-1))			}		}	}});$(document).on('click','.aw-card-tips-topic .focus',function(){	var topicid = $(this).parents('.aw-card-tips').find('.name').attr('cashid');	for (var i=0; i<cashTopicData.length; i++)	{		//存在缓存		if (cashTopicData[i].match('cashid="'+topicid+'"'))		{			if (cashTopicData.length == 1)			{				cashTopicData = [];			}else			{				cashTopicData = cashTopicData.splice(0,i).concat(cashTopicData.splice(i,cashTopicData.length-1))			}		}	}});/*返回顶部*/		function go_to_top(){	/*gototop定位*/	if ($('#alert-publich-box')[0]){		$('.aw-gototop').css({			left : $('#alert-publich-box').offset().left + 127		});	}	/*滚动条滚动出现tototop按钮*/	$(window).scroll(function(){		if ($(window).scrollTop() > 300)		{			$('.aw-gototop').fadeIn();		}else		{			$('.aw-gototop').fadeOut();		}	});	/*gototop效果*/	$('.aw-gototop').click(function()	{		$('body,html').animate({			scrollTop: 0		}, 800);		return false;	});}		/*搜索下拉*/function search_tips(selecter,limit){	var keyword;	$(selecter).on({		focus : function()		{			//清空列表数据			$('.aw-search-dropdown-box .aw-search-dropdown-list').empty();			$('.aw-search-dropdown-box').show();			/*给三角形定位*/			$('.aw-search-dropdown-box .i-dropdown-triangle').css('left',($(this).width())/2+50);		},		keyup : function()		{			if ($(this).val().length > 2)			{				//清空下拉菜单				$('.aw-search-dropdown-box .aw-search-dropdown-list').empty();				//请求获取数据				$.ajax({					type : 'GET',					url : G_BASE_URL + '/search/ajax/search/?q=' + $(this).val() + '&limit=' + limit,					dataType : 'json',					success : function(result){						for (var i=0;i<result.length;i++)						{							add_search_dropdown_list('.aw-search-dropdown-box .aw-search-dropdown-list',parseInt(result[i].type),result[i],keyword);						}					}				});								$('.aw-search-dropdown-box .search a').text($(this).val());				$('.aw-search-dropdown-box .search').show();				$('.aw-search-dropdown-box .title').hide();							}else			{				$('.aw-search-dropdown-box .title').text('请输入两个以上关键字...').show();				$('.aw-search-dropdown-box .search').hide();				$('.aw-search-dropdown-box .aw-search-dropdown-list').empty();			}			$('.aw-search-dropdown-box .txt').text($(this).val());			keyword = $(this).val();		},		blur : function(){			searchtimeout = setTimeout(function(){				$('.aw-search-dropdown-box').hide();			},500);		}	});		//下拉菜单发起问题绑定	$('.aw-search-dropdown-box .publish').click(function(){		$('#aw-ajax-box').html(Hogan.compile(AW_TEMPLATE.publishBox).render({			'message' : keyword		}));		/*补充说明操作*/		$('.aw-publish-box-supplement').click(function()		{			$(this).parents('form').find('.aw-publish-box-supplement-content').toggle();		});		/*动态插入下拉菜单模板*/		add_dropdown_list('.aw-publish-title-dropdown',[			{'name' : 'Anwsion程序'},			{'name' : '建站运营'},			{'name' : '创意与设计'},			{'name' : '问与答'}		]);		$('.aw-publish-box-supplement-content').on({			keydown : function(event)			{ 				if (event.which == 13)				{					switch ($(this).val().split('\n').length)					{						case 4 : $(this).css('height',parseInt($(this).css('height'))+20);								 break;						case 5 : $(this).css('height',parseInt($(this).css('height'))+20);								 break;						case 6 : $(this).css('height',parseInt($(this).css('height'))+20);								 break;						case 7 : $(this).css('height',parseInt($(this).css('height'))+20);								 break;						case 8 : $(this).css('height',parseInt($(this).css('height'))+20);								 break;					}				}			}		});		//box拖拽		dragBox('.alert-box .modal-header');		//box居中		$('.alert-box').css({			left : $(window).width()/2 - $('.alert-box').width()/2		});		//box显示		$('.alert-box').modal('show');		$('.aw-search-dropdown-box').hide();	})	}/*搜索下拉菜单*/function add_search_dropdown_list(selecter,type,json,keyword){	switch (type) // type1 : 问题 , type2 : 话题 best_answer最佳回答, type3 : 用户	{		case 1 : 				if(json.detail.best_answer > 0)				{					var active = 'active';				}else				{					var active = ''				}				$(selecter).append(Hogan.compile(AW_TEMPLATE.searchDropdownList1).render({					'url' : G_BASE_URL + json.url,					'active' : active,					'content' : json.name,					'discuss_count' : json.detail.answer_count				}));				//高亮显示				$('.aw-search-dropdown-list .question a').highText(keyword, 'span', 'active');				break;		case 2 : $(selecter).append(Hogan.compile(AW_TEMPLATE.searchDropdownList2).render({			'url' : G_BASE_URL + json.url,			'name' : json.name,			'discuss_count' : json.detail.discuss_count,			'topicid' : json.detail.topic_id 		}));				break;		case 3 : if (json.detail.signature == '')				{					var signature = '暂无介绍';				}else				{					var signature = json.detail.signature;				}				$(selecter).append(Hogan.compile(AW_TEMPLATE.searchDropdownList3).render({					'url' : G_BASE_URL + json.url,					'uid' : json.uid,					'img' : json.detail.avatar_file,					'name' : json.name,					'intro': signature				}));			break;	}}