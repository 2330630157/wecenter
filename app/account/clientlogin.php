<?php/*+--------------------------------------------------------------------------|   WeCenter [#RELEASE_VERSION#]|   ========================================|   by WeCenter Software|   © 2011 - 2013 WeCenter. All Rights Reserved|   http://www.wecenter.com|   ========================================|   Support: WeCenter@qq.com|   +---------------------------------------------------------------------------*/if (!defined('IN_ANWSION')){	die;}class clientlogin extends AWS_CONTROLLER{	public function get_access_rule()	{		$rule_action['rule_type'] = 'black';				$rule_action['actions'] = array();				return $rule_action;	}		public function index_action()	{		if ($this->model('account')->get_clientlogin_sign($_GET['user_name']) == $_GET['sign'])		{			if (!$user_info = $this->model('account')->get_user_info_by_username($_GET['user_name']))			{				H::redirect_msg('用户不存在');			}						$this->model('account')->update_user_last_login($user_info['uid']);			$this->model('account')->setcookie_logout();						$this->model('account')->setcookie_login($user_info['uid'], $user_info['user_name'], $user_info['password'], $user_info['salt'], null, false);		}				H::redirect_msg('签名无效或已过期');	}}