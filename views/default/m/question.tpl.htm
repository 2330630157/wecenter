<?php TPL::output('m/header.tpl.htm'); ?>

<div data-role="page">
	<div data-role="header" data-position="fixed" data-theme="b" data-add-back-btn="true">
		<?php if (strstr($_SERVER['HTTP_REFERER'], '/m/')) { ?>
		<a href="#" data-direction="reverse" data-rel="back" data-role="button">返回</a>
		<?php } else { ?>
		<a href="m/" data-ajax="false" data-role="button">返回</a>
		<?php } ?>
		
		<h1><?php echo $this->question_info['answer_count']; ?> 个回答</h1>
		
		<a href="m/" data-ajax="false" data-role="button">首页</a>
	</div><!-- /header -->

	<div data-role="content" class="m_contents">	
		<div class="content-primary" data-theme="d">
			<div class="question_content">
				<?php if ($this->question_topics) { ?>
				<div class="tags">
					<?php foreach($this->question_topics as $key => $val) { if ($key > 3) { break; } ?>
						<a href="m/topic/<?php echo $val['url_token']; ?>"><?php echo $val['topic_title']; ?></span></a>
					<?php } ?>
					
					<?php if (sizeof($this->question_topics) > 3) { ?>
					<a href="#"><span>...</span></a>
					<?php } ?>
				</div>
				<?php } ?>
			
				<h3><?php echo $this->question_info['question_content']; ?></h3>

				<?php echo $this->question_info['question_detail']; ?>
			</div>
			<div class="question_meta ui-grid-a">
				<div class="ui-block-a">
					<a href="#" class="icon_label views"><?php echo $this->question_info['view_count']; ?></a>
					<a href="m/comments_list/question_id-<?php echo $this->question_info['question_id']; ?>" class="icon_label comments"><?php echo $this->question_info['comment_count']; ?></a>
				</div>
				
				<div class="ui-block-b">
					<!--<a href="#" data-role="button" data-icon="delete" data-inline="true" data-mini="true">取消关注</a>-->
					<a href="#" onclick="focus_question($(this), $(this).find('span.ui-btn-text'), <?php echo $this->question_info['question_id']; ?>);" data-role="button" data-icon="<?php if ($this->question_focus) { ?>delete<?php } else { ?>check<?php } ?>" data-theme="<?php if ($this->question_focus) { ?>c<?php } else { ?>b<?php } ?>" data-inline="true" data-mini="true"><?php if ($this->question_focus) { ?><?php _e('取消关注'); ?><?php } else { ?><?php _e('关注'); ?><?php } ?></a>
				</div>
			</div>
			<a href="m/add_answer/question_id-<?php echo $this->question_info['question_id']; ?>" class="question_add_answer" data-ajax="false">
				<strong>+</strong> 添加答案
			</a>
			
			<?php if ($this->answers_list) { ?>
			<ul class="question_answers">
				<?php foreach ($this->answers_list AS $key => $val) { ?>
				<li class="ui-grid-a">
					<div class="ui-block-a">
						<img src="<?php echo get_avatar_url($val['uid'], 'mid'); ?>" alt="" width="32" height="32" />
						<span class="counts"><?php echo $val['agree_count']; ?></span>
					</div>
				
					<div class="ui-block-b">
						<h4 class="user_name"><?php if ($val['anonymous']) { ?><?php _e('匿名用户'); ?><?php } else { ?><a href="mobile/people/<?php echo $val['url_token']; ?>"><?php echo $val['user_name']; ?></a><?php } ?></h4>
				
						<?php echo FORMAT::parse_attachs($val['answer_content']); ?>
					</div>
				</li>
				<?php } ?>
			</ul>
			<?php } ?>
			
			<?php if ($this->next_page) { ?>
			<p class="load_more"><a href="m/question/<?php echo $this->question_info['question_id']; ?>?page-<?php echo $this->next_page; ?>" data-role="button">下一页</a></p>
			<?php } ?>
		</div>

	</div><!-- /content -->
</div><!-- /page -->

<?php TPL::output('m/footer.tpl.htm'); ?>