<?php TPL::output('global/header.tpl.htm'); ?>

<div class="aw-container-wrap zc-container-wrap zc-project-container-wrap">
    <div class="aw-container aw-wecenter">
        <div class="container">
            <div class="row zc-payment">
                <form action="project/ajax/add_product_order/" method="post" onsubmit="return false" id="order_form">
                <input type="hidden" name="project_id" value="<?php echo $this->product_info['project_id']; ?>" />
                <input type="hidden" name="product_id" value="<?php echo $this->product_info['id']; ?>" />
                <div class="col-sm-9">
                    <div class="mod content">
                        <div class="mod-head">
                            <h2><?php _e('回报内容'); ?></h2>
                        </div>
                        <div class="mod-body">
                            <p>
                                <?php echo nl2br($this->product_info['description']); ?>
                            </p>
                            <label><input type="checkbox" name="is_donate" value="1" /> <?php _e('不需要回报, 纯粹支持 (选择此项, 项目成功后发起人将不会给您发送回报)'); ?></label>
                        </div>
                    </div>
                    <?php if (intval($this->product_info['amount']) == 0) { ?>
                    <div class="mod amount">
                        <div class="mod-head">
                            <h2><?php _e('不定额支持'); ?></h2>
                        </div>
                        <div class="mod-body">

                            <dl class="dl-horizontal">
                                <dt><?php _e('支持金额'); ?>:</dt>
                                <dd><input type="text" class="form-control form-normal" name="amount" placeholder="<?php _e('请输入您要支持的金额数'); ?>"/></dd>
                            </dl>

                        </div>
                    </div>
                    <?php } ?>
                    <div class="mod address">
                        <div class="mod-head">
                            <h2><?php _e('收货信息'); ?></h2>
                        </div>
                        <div class="mod-body">
                            <dl class="dl-horizontal">
                                <dt><?php _e('收件人姓名'); ?>:</dt>
                                <dd><input type="text" class="form-control form-normal" name="shipping_name" /></dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt><?php _e('省份/直辖市'); ?>:</dt>
                                <dd>
                                    <select name="shipping_province" class="select_area"></select> <select name="shipping_city" class="select_area"></select>
                                </dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt><?php _e('详细地址'); ?>:</dt>
                                <dd><input type="text" class="form-control form-normal" name="shipping_address" /></dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt><?php _e('邮政编码'); ?>:</dt>
                                <dd><input type="text" class="form-control form-normal" name="shipping_zipcode" /></dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt><?php _e('收件人手机'); ?>:</dt>
                                <dd><input type="text" class="form-control form-normal" name="shipping_mobile" /></dd>
                            </dl>
                        </div>
                    </div>
                    <div class="mod remark">
                            <div class="mod-head">
                                <h2><?php _e('备注信息'); ?></h2>
                            </div>
                            <div class="mod-body">
                                <textarea class="form-control" rows="4" placeholder="<?php _e('在此填写关于回报内容的具体选择或者任何你想告诉项目发起人的话'); ?>" name="note"></textarea>
                            </div>
                    </div>
                    <a onclick="AWS.ajax_post($('#order_form'))" class="btn btn-success btn-green"><?php _e('确定提交'); ?></a>
                </div>
                <div class="col-sm-3 aw-side-bar">
                    <div class="zc-project-list">
                        <ul>
                            <li>
                                <div class="mod-head">
                                    <a href="project/<?php echo $this->project_info['id']; ?>" class="img"><img src="<?php echo get_setting('upload_url'); ?>/project/<?php echo $this->project_info['id']; ?>_main.jpg" alt="" title="" /></a>
                                </div>
                                <div class="mod-body">
                                    <h3><a href="project/<?php echo $this->project_info['id']; ?>"><?php echo $this->project_info['title']; ?></a></h3>
                                    <div class="desc">
                                        <?php _e('话题'); ?>: <?php echo $this->project_info['discuss_count']; ?>
                                        <?php _e('支持'); ?>: <?php echo $this->project_info['sponsored_users']; ?>
                                        <span class="pull-right label label-green"><?php if (!$this->project_info['approved']) { ?><?php _e('待审核'); ?><?php } else if ($this->project_info['end_time'] < time()) { ?><?php _e('已结束'); ?><?php } else if ($this->project_info['start_time'] > time()) { ?><?php _e('预热中'); ?><?php } else { ?><?php if ($this->project_info['paid'] > 0) { ?><?php _e('已筹到'); ?><?php } else if ($this->project_info['paid'] >= $this->project_info['amount']) { ?><?php _e('已成功'); ?><?php } else { ?><?php _e('活动中'); ?><?php } ?><?php } ?></span>
                                    </div>
                                    <div class="progress">
                                      <div class="progress-bar progress-bar-success progress-bar-green" role="progressbar" aria-valuenow="<?php echo get_paid_progress_bar($this->project_info['amount'], $this->project_info['paid']); ?>" aria-valuemin="0" aria-valuemax="<?php echo get_paid_progress_bar($this->project_info['amount'], $this->project_info['paid']); ?>" style="width: <?php echo get_paid_progress_bar($this->project_info['amount'], $this->project_info['paid']); ?>%">
                                        <span class="sr-only"></span>
                                      </div>
                                    </div>
                                </div>
                                <div class="mod-footer">
                                    <div class="status">
                                        <span href="">
                                            <b><?php echo get_paid_progress_bar($this->project_info['amount'], $this->project_info['paid']); ?>%</b>
                                            <?php _e('已达到'); ?>
                                        </span>
                                        <span href="">
                                            <b>¥ <?php echo $this->project_info['paid']; ?></b>
                                            <?php _e('已获支持'); ?>
                                        </span>
                                        <span href="" class="pull-right">
                                            <b><?php echo get_left_days($this->project_info['end_time']); ?></b>
                                            <?php _e('剩余时间'); ?>
                                        </span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        // 地址初始化
        $('.select_area').LocationSelect({
            labels: ["<?php _e('请选择省份或直辖市'); ?>", "<?php _e('请选择城市'); ?>"],
            elements: document.getElementsByTagName("select"),
            detector: function () {
                this.select(["", ""]);
            },
            dataUrl: G_BASE_URL + '/account/ajax/areas_json_data/'
        });

        $('input[name="is_donate"]').click(function() {
            if ($('input[name="is_donate"]').is(':checked'))
            {
                $('.amount').css('display', 'none');
                $('.address').css('display', 'none');
            }
            else
            {
                $('.amount').removeAttr('style');
                $('.address').removeAttr('style');
            }
        });
    });
</script>

<?php TPL::output('global/footer.tpl.htm'); ?>
