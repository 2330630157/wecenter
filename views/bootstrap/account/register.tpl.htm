<?php TPL::output('global/header_landing.tpl.htm'); ?>

<script type="text/javascript">
	$(document).ready(function () {
		$('#header_action').append('<?php _e('注册新用户'); ?>');
	});
</script>

<div class="aw-register-box">
	<form class="aw-register-form" action="account/ajax/register_process/" method="post" id="register_form">
		<?php if ($this->icode) { ?><input type="hidden" name="icode" id="icode" value="<?php echo $this->icode; ?>" /><?php } ?>
		<?php if ($this->return_url) { ?><input type="hidden" name="return_url" value="<?php echo $this->return_url; ?>" /><?php } ?>
		<?php if ($this->fromuid AND $_GET['invite_question_id']) { ?>
		  	<input type="hidden" name="invite_question_id" value="<?php echo htmlspecialchars($_GET['invite_question_id']); ?>"/> 
		<?php } ?>
		<ul>
			<li>
				<input class="aw-register-name" type="text" name="user_name" placeholder="<?php _e('用户名'); ?>" tips="<?php _e('请输入一个 2-14 位的用户名');?>" errortips="" value="" />
			</li>
			<li>
				<input class="aw-register-email" type="text" placeholder="<?php _e('邮箱'); ?>" name="email" tips="<?php _e('请输入你常用的电子邮箱作为你的账号'); ?>" errortips="<?php _e('邮箱格式不正确'); ?>" />
			</li>
			<li>
				<input class="aw-register-pwd" type="password" name="password" placeholder="密码" tips="<?php _e('请输入 6-16 个字符,区分大小写'); ?>" errortips="<?php _e('密码不符合规则'); ?>" />
			</li>
			<li class="aw-register-verify">
				<em class="auth-img pull-right"><img id="seccode" onclick="this.src = G_BASE_URL + '/account/captcha/' + Math.floor(Math.random() * 10000);" src=""></em>
				<input type="text" placeholder="<?php _e('验证码'); ?>" tips="<?php _e('验证码不区分大小写,点击图片可换一张'); ?>" errortips="" />
			</li>
			<li class="last">
				<label><input type="checkbox" checked="checked" value="agree" name="agreement_chk" /> <?php _e('我同意'); ?></label> <a href="javascript:;" onclick="$('.aw-regiter-agreement').toggle();"><?php _e('用户协议'); ?></a>
				<div class="aw-regiter-agreement hide">
					<i></i>
					<div class="aw-register-agreement-txt" id="register_agreement"></div>
				</div>
			</li>
			<li>
				<button class="pull-right btn btn-large btn-success" onclick="ajax_post($('#register_form')); return false;"><?php _e('注册'); ?></button>
			</li>
		</ul>
	</form>
</div>

<script type="text/javascript">
$(function(){

	$('.aw-register-name').on({
		focus : function()
		{
			$(this).parent().append('<span class="aw-reg-tips">'+$(this).attr('tips')+'</span>');
		},
		blur : function()
		{
			$(this).parent().find('.aw-reg-tips').detach();
			if ($(this).val().length > 0 && $(this).val().length < 3)
			{
				$(this).parent().append('<span class="aw-reg-err"><i class="aw-icon i-err"></i>'+$(this).attr('errortips')+'</span>');
			}
			if ($(this).val().length > 17)
			{
				$(this).parent().append('<span class="aw-reg-err"><i class="aw-icon i-err"></i>'+$(this).attr('errortips')+'</span>');
			}
		}
	});
	$('.aw-register-email').on({
		focus : function()
		{
			$(this).parent().append('<span class="aw-reg-tips">'+$(this).attr('tips')+'</span>');
		},
		blur : function()
		{
			$(this).parent().find('.aw-reg-tips').detach();
			var emailreg = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
			if (!emailreg.test($(this).val()))
			{
				$(this).parent().append('<span class="aw-reg-err"><i class="aw-icon i-err"></i>'+$(this).attr('errortips')+'</span>');
			}else
			{
				$(this).parent().append('<span class="aw-reg-right"><i class="aw-icon i-followed"></i></span>');
			}
		}
	});
	$('.aw-register-pwd').on({
		focus  : function()
		{
			$(this).parent().append('<span class="aw-reg-tips">'+$(this).attr('tips')+'</span>');
		},
		blur : function()
		{
			$(this).parent().find('.aw-reg-tips').detach();
			if ($(this).val().length > 0 && $(this).val().length < 6)
			{
				$(this).parent().append('<span class="aw-reg-err"><i class="aw-icon i-err"></i>'+$(this).attr('errortips')+'</span>');
			}
			if ($(this).val().length > 17)
			{
				$(this).parent().append('<span class="aw-reg-err"><i class="aw-icon i-err"></i>'+$(this).attr('errortips')+'</span>');
			}else
			{
				$(this).parent().find('.aw-reg-tips').detach();
				$(this).parent().append('<span class="aw-reg-right"><i class="aw-icon i-followed"></i></span>');
			}
		}
	});

	
});
</script>

<script type="text/javascript">
	$(document).ready(function () {
		$.get(G_BASE_URL + '/account/ajax/register_agreement/', function (result) { $('#register_agreement').html(result.err); }, 'json');
		
		if ($('#seccode').length)
		{
			$('#seccode').click();
		}
	});
</script>

<?php TPL::output('global/footer_blank.tpl.htm'); ?>